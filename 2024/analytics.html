<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>starly dot dev - Setting up analytics with Umami</title>
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="starly.dev" />
        
        <meta property="og:type" content="article" />
        <meta property="og:url" content="../2024/analytics.html" />
        <meta property="og:title" content="Setting up analytics with Umami" />
        <meta name="twitter:title" content="Setting up analytics with Umami" />
        <meta property="og:description" content="<p>How I set up website analytics tracking with Umami</p>" />
        <meta name="twitter:description" content="<p>How I set up website analytics tracking with Umami</p>" />
        <meta property="og:image" content="../extra/og-default.png" />
        <meta name="twitter:image" content="../extra/og-default.png" />
        <script defer src="https://umami.starly.dev/script.js" data-website-id="1c0e4704-fd15-4764-8b0a-bb7c925ea6d1"></script>        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda"/>
        <link rel="stylesheet" type="text/css" href="../theme/css/main.css"/>

<meta name="tags" content="misc" />
</head>
<body>
<style>.github-corner:hover .octo-arm {
    animation: octocat-wave 560ms ease-in-out
}
@keyframes octocat-wave {
    0%, 100% {
        transform: rotate(0)
    }
    20%, 60% {
        transform: rotate(-25deg)
    }
    40%, 80% {
        transform: rotate(10deg)
    }
}
@media (max-width: 500px) {
    .github-corner:hover .octo-arm {
        animation: none
    }

    .github-corner .octo-arm {
        animation: octocat-wave 560ms ease-in-out
    }
}</style><div id="container">
    <header>
        <h1><a href="../">starly dot dev</a></h1>
            <ul class="social-media">
                    <li><a href="https://github.com/mr4tt" target="_blank" data-umami-event="fa-brands fa-github"><i class="fa-brands fa-github" aria-hidden="true"></i></a></li>
                    <li><a href="mailto:hello.mrat@gmail.com" target="_blank" data-umami-event="fa-regular fa-envelope"><i class="fa-regular fa-envelope" aria-hidden="true"></i></a></li>
            </ul>
        <p><em></em></p>
    </header>
    <nav>
        <ul>
                    <li><a href="../category/comics.html" data-umami-event="Comics">Comics</a></li>
                    <li><a  class="active" href="../category/misc.html" data-umami-event="Misc">Misc</a></li>
                    <li><a href="../category/portfolio.html" data-umami-event="Portfolio">Portfolio</a></li>
                    <li><a href="../pages/about-me.html" data-umami-event="About Me">About Me</a></li>
        </ul>
    </nav>
<main>
    <article>
        <h1>Setting up analytics with Umami</h1>
        
        <aside>
            <ul>
                <li>
                    <time datetime="2024-04-05 19:37:00-07:00">Apr 05, 2024</time>
                </li>
                <!--  -->
                <li>
                    Categories:
                    <a href="../category/misc.html"><em>Misc</em></a>
                </li>
                <li>
                    Tags:
                    <a href="../tag/misc.html"><em>#misc</em></a>
                </li>
            </ul>
        </aside>
        <h2>title</h2>
<p>This website is built using Pelican, hosted on Github Pages, and now has analytics from <a class="blue-link" href="https://umami.is/">Umami</a> (is that how you SEO?).</p>
<p>Analytics dashboard <a href="https://umami.starly.dev/share/hNfhWdonj5bA5dBj/starly.dev">here</a>. </p>
<p>Umami is an open source metrics collecterer (?) from people who visit your website, focused on privacy. Google Analytics does the same thing but after two minutes of Googling it, I decided I didn't want to make an account. And lack of privacy and GDPR non-compliant or something. </p>
<p>There's other Google Analytics alternatives, but they cost money, so I didn't get very far down their home pages. </p>
<h2>Set up</h2>
<ul>
<li>i am using Ubuntu 23.10 on a Digital Ocean instance</li>
<li>install Node.js</li>
<li>install PostgreSQL<ul>
<li>you can also use MySQL, but this post uses postgres</li>
</ul>
</li>
<li>install Nginx</li>
</ul>
<p>actual install docs from umami <a href="https://umami.is/docs/install">here</a></p>
<ol>
<li>run <code>corepack enable</code><ul>
<li>adds yarn binary to path </li>
</ul>
</li>
</ol>
<p>yarn installation docs <a href="https://yarnpkg.com/getting-started/install">here</a></p>
<ol>
<li>
<p>Set up umami</p>
<ul>
<li><code>git clone https://github.com/umami-software/umami.git</code></li>
<li><code>cd umami</code></li>
<li><code>yarn</code><ul>
<li>installs packages</li>
</ul>
</li>
</ul>
</li>
<li>
<p>set up postgres</p>
<ul>
<li><code>createdb -U postgres --host=localhost umami</code> to create a db called umami</li>
<li>create a <code>.env</code> file in the cloned umami folder with your connection string <ul>
<li>DATABASE_URL=postgresql://[USERNAME]:[PASSWORD]@[DB_LOCATION]/[DATABASE_NAME]</li>
<li>in my case, my file had <code>DATABASE_URL=postgresql://username:password@localhost:5432/umami</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>build</p>
<ul>
<li><code>yarn build</code><ul>
<li>note: i needed to configure more swap on my poor server, building eats a lot of memory</li>
</ul>
</li>
<li>some optional things:<ul>
<li><code>yarn next telemetry disable</code> to disable Next.js telemetry</li>
<li>to change the port next.js uses (default is 3000), go to package.json, change <code>next start</code> to be <code>next start -p [port]</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>start </p>
<ul>
<li><code>npm start</code></li>
<li>optional: use pm2, a process manager, to manage your umami instance<ul>
<li>the steps below will install pm2 globally, start the umami instance, and save it so you can restart it next time </li>
<li><code>npm install pm2 -g</code></li>
<li><code>pm2 start npm --name umami -- start</code> (make sure you're in the umami folder before running)</li>
<li><code>pm2 save</code></li>
</ul>
</li>
<li>go to http://[IP]:3500/</li>
<li>log in:<ul>
<li>username: admin</li>
<li>password: umami</li>
</ul>
</li>
<li>go to settings to change your password</li>
</ul>
</li>
<li>
<p>set up site</p>
<ul>
<li>go to settings &gt; websites</li>
<li>add website<ul>
<li>name: can be anything you want (ex: starly)</li>
<li>domain: your website domain (ex: starly.dev)</li>
</ul>
</li>
<li>click edit &gt; tracking code <ul>
<li>copy tracking code and put it somewhere in the <code>&lt;head&gt;...&lt;/head&gt;</code> tags of your website</li>
</ul>
</li>
<li>optional:<ul>
<li>edit &gt; enable share URL if you'd like to share the dashboard with anyone or link it on your website</li>
</ul>
</li>
</ul>
</li>
<li></li>
</ol>
<p>Next, I started my Umami instance. I had to log in; I suppose that means I made an account somewhere along the way. There goes my reason for not using Google Analytics. </p>
    </article>
    <section class="post-nav">
        <div id="left-page">
            <div id="left-link">
            </div>
        </div>
        <div id="right-page">
            <div id="right-link">
            </div>
        </div>
    </section>
    <div>
    </div>
</main>
    <footer>
        <h6>
            Rendered by <a href="http://getpelican.com/">Pelican</a> &nbsp;&bull;&nbsp; Theme by <a href="https://github.com/aleylara/Peli-Kiera">Peli-Kiera</a> 
            &nbsp;&bull;&nbsp;   By mrat         </h6>
    </footer>
</div>
</body>
</html>
